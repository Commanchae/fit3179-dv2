{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "background":"#FCFFF7",
  "data": { "url": "australian-netflow.csv"},
  "width": "container",
  "height": 200,
  "layer":[
{  "mark": {"type":"bar", "cornerRadius":5},
  "title": {"text": "Australia's Migration Inflow vs. Outflow over Time", "color":"#286d86"},
  "transform": [
    {"calculate": "'In ' + datum.year + ', ~'+ (ceil((abs(datum.flow)/1000)))+ ',000 internationals '  + (datum.type == 'Inflow'? 'came into ': 'left ') + ' Australia.'", "as": "Insight"}
  ],
  "encoding": {
    "x": {
      "field": "year",
      "sort": "ascending",
      "axis": {
        "labelAngle": -45,
        "titleColor": "#286d86"
      }
    },
    "y": {
      "aggregate": "sum", "field": "flow",
      "title": "Flow",

      "axis": {"format": "s",
    "titleX": -56,
  "titleColor": "#286d86",
  "labelColor": "#286d86"
}
    },
    "color": {
      "field": "type",
      "scale": {"range": ["#006dd4", "#a5a3ff"]},
      "legend": {"orient": "right", "title": "Flow Type", "titleColor": "#286d86",                "labelColor": "#286d86"}
    },
    "tooltip":      
    [
      {"field": "Insight", "type": "nominal", "title":null}
    ]

  },
  "config": {
    "view": {"stroke": null},
    "axis": {"grid": false}
  }},
  {
    "data": {"values": [{"x": 2020, "y": 0}]},
    "mark": "rule",
    "encoding": {
      "x": {
        "field": "x",
        "axis": {
          "labelColor": "#286d86"
        }
      },
      "color": {
        "value": "red"
      },
      "size": {
        "value": 2
      }
  
    }
  },
  {
    "data": {"values": [{"x": 2020, "y": 0}]},
    "mark": {"type":"text", "dy":-110},
    "encoding": {
      "x": {
        "field": "x",
        "axis": {
          "title": "Year"
        }
      },
      "color": {"value": "#286d86"},
      
      "text": {
        "value": "Covid pandemic started."
      }
  
    }
  },
  {
    "data": {"values": [{"x": 2018, "y": 0}]},
    "mark": {"type":"text", "dx":-10,"dy": -85},
    "encoding": {
      "x": {
        "field": "x",
        "axis": {
          "title": "Year"
        }
      },
      "color": {"value": "#286d86"},
      "text": {
        "value": "The pandemic saw a huge"
      }
  
    }
  },
  {
    "data": {"values": [{"x": 2019, "y": 0}]},
    "mark": {"type":"text", "dx":-20,"dy": -70},
    "encoding": {
      "x": {
        "field": "x",
        "axis": {
          "title": "Year"
        }
      },
      "color": {"value": "#286d86"},
      "text": {
        "value": "decrease in inflow."
      }
  
    }
  },
  {
    "data": {"values": [{"x": 2022, "y": 0}]},
    "mark": {"type":"text", "dx":-50, "fontSize": 35, "angle": -135},
    "encoding": {
      "x": {
        "field": "x",
        "axis": {
          "title": "Year"
        }
      },
      
      "text": {
        "value": "âžŸ"
      }
  
    }
  },
  {
    "data": {"values": [{"x": 2022, "y": 0}]},
    "mark": {"type":"text", "dx":80,"dy": 60},
    "encoding": {
      "x": {
        "field": "x",
        "axis": {
          "title": "Year"
        }
      },
      "color": {"value": "#286d86"},
      "text": {
        "value": "Major increase in inflow"
      }
  
    }
  },
  {
    "data": {"values": [{"x": 2022, "y": 0}]},
    "mark": {"type":"text", "dx":80,"dy": 75},
    "encoding": {
      "x": {
        "field": "x",
        "axis": {
          "title": "Year"
        }
      },
      "color": {"value": "#286d86"},
      "text": {
        "value": "after pandemic."
      }
  
    }
  }
]
}